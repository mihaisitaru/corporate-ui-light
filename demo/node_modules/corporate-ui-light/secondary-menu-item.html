<link rel="import" href="../polymer-1.4.0/polymer.html">
<link rel="import" href="behaviors/menu-behavior.html">
<link rel="import" href="behaviors/global-behavior.html">
<dom-module id="secondary-menu-item">

  <template>

    <style>
         :host .dropdown.open .caret {
             transform: rotate(180deg);
         }
         :host .navbar-nav .dropdown-menu li a {
             padding: 7px 2px;
             text-transform: capitalize;
             color: #555;
         }
         :host .navbar-nav .dropdown-menu li a:before {
             padding-right: 0;
             padding-left: 0;
         }
    </style>

      <ul class="nav navbar-nav navbar-right">
          <template is="dom-if" if="[[dropdownMenu]]">
              <li class="dropdown" >
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">[[title]]
                  <span class="caret"></span>
              </a>

                <ul class="dropdown-menu">
               <template is="dom-repeat" items="{{items}}">
                 <li class$="{{conditionalClass('active', item.active)}}">
                    <a href="[[item.href]]" target="{{conditionalAttr(item.target)}}">[[item.title]]</a>
                </li>
              </template>
              </ul>
            </li>
          </template>
          <template is="dom-if" if="[[!dropdownMenu]]">
               <template is="dom-repeat" items="{{items}}">
                 <li class$="{{conditionalClass('active', item.active)}}">
                    <a href="[[item.href]]" target="{{conditionalAttr(item.target)}}">[[item.title]]</a>
                </li>
              </template>
          </template>
        <li>
          <content></content>
        </li>
      </ul>


  </template>

  <script>
  Polymer({
      is: 'secondary-menu-item',
      behaviors: [CUIBehaviors.MenuBehavior, CUIBehaviors.GlobalBehavior],
      properties: {
          dropdown: {
              type: String,
              value: '',
              observer: '_onDropdownActive'
          },
          identification: {
              id: 'secondary-menu-item'
          }
      },
      attached: function () {
          this.setActiveMenu('.secondary-menu-item.active');
      },
      onToggleSubmenu: function(event){
          var activeSubmenu = this.getActiveSubmenu(event.target.parentNode.title, event.target.parentNode.id);
          this.resetMenu('.subnav.open', '.secondary-menu-item');

          activeSubmenu.classList.add('open');
          event.target.parentNode.toggleClass('active');
      },
      _onDropdownActive: function () {
          this.dropdownMenu = (this.dropdown === 'true');
      }

  });
  </script>

</dom-module>

