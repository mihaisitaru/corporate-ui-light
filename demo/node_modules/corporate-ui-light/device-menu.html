<link rel="import" href="../polymer-1.4.0/polymer.html">
<link rel="stylesheet" href="https://static.scania.com/resources/icons/font-awesome/5.3.1/css/all.min.css">
    <link rel="stylesheet"
          href="https://d31jnweo1ynb8u.cloudfront.net/vendors/frameworks/bootstrap/3.2.0/dist/css/bootstrap-org.css">
    <link rel="stylesheet" href="https://d31jnweo1ynb8u.cloudfront.net/build/global/3.5.0/css/corporate-ui.css">
<link rel="stylesheet" href="../bootstrap-treeview/dist/bootstrap-treeview.min.css">

<dom-module id="ks-device-menu">

  <template>

    <style>
       /*.treeview .list-group-item {*/
           /*padding: 10px 5px;*/
       /*}*/

       /*.treeview .list-group-item {*/
           /*background-color: transparent;*/
           /*text-overflow: ellipsis;*/
           /*overflow: hidden;*/
           /*width: 80%;*/
           /*word-break: normal;*/
           /*white-space: nowrap;*/
       /*}*/

       /*.treeview .list-group {*/
           /*font-weight: inherit;*/
       /*}*/

    </style>
      <div class="visible-sm visible-xs">
        <div class="collapse navbar-collapse main-nav device-menu main-nav" id="deviceMenu">
             I am the device menu
         </div>
    </div>
  </template>
    <script src="../bootstrap-treeview/src/js/bootstrap-treeview.js"></script>
  <script>
  Polymer({
      is: 'ks-device-menu',
      behaviors: [CUIBehaviors.GlobalBehavior],

      ready: function () {
          this.allMenuItems = [];
          document.addEventListener('menu-items-added', this._onMenuItemsAdded.bind(this));
      },
      count: 4,
      _onMenuItemsAdded: function (event) {
          this.mergeArray(event.detail.menuItems, this.allMenuItems);
          console.log('this.allMenuItems', this.allMenuItems);
          if (this.count > 1) {
              this.count -= 1;
              return;
          }
          this.buildMenu();
      },
      buildMenu: function () {
          var options = {
              showBorder: false,
              color: '#53565a',
              collapseIcon: 'none',
              expandIcon: 'none',
              emptyIcon: 'none',
              enableLinks: true,
              customSelectedStyle: 'border-left: 4px solid #4a8ba4; ' +
              'color: #4a8ba4;background-color: transparent;font-family: "Scania Sans Semi Condensed";' +
              'font-weight: bold;',
              customExpandedStyle: 'font-family: "Scania Sans Semi Condensed";font-weight: bold;color: #041e42;',
              customNodeStyle: 'padding: 10px 5px;background-color: transparent;text-overflow: ellipsis;overflow: hidden;' +
                                'width: 80%;word-break: normal;white-space: nowrap;',
              indentNode: true,
              data: this.allMenuItems,
              decorator: this.decorateNode
          };

          $('#deviceMenu').treeview(options);
          $('#deviceMenu').treeview('collapseAll', {silent: true});
      },
      decorateNode: function (node) {
          console.log('node', node);
          node.text = node.title;
          return node;
      }
  });
  </script>

</dom-module>

