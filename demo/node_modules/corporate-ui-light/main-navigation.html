<link rel="import" href="../polymer-1.4.0/polymer.html">
<link rel="import" href="main-header.html">

<dom-module id="ks-main-navigation">

  <template>

   <style>
     :host, :host .main-menu {
       background-color: rgb(255, 255, 255);
     }
     :host .navbar-nav ::content a {
         line-height: 20px;
         position: relative;
         display: block;
         color: #909090;
     }

     :host .navbar-nav .active ::content a,
     :host .navbar-nav ::content a:hover,
     :host .navbar-nav ::content a:focus {
       color: #041e42;
     }
     :host .navbar-nav {
       margin-bottom: 0;
     }
     :host .navbar-nav > li.dropdown.open {
       position: static;
     }
     :host .navbar-nav > li.dropdown.open .dropdown-menu {
       width: 100%;
       left: 0;
       right: 0;
       top: 100%;
       background-color: #f5f5f5;
       margin-bottom: 0;
       padding-left: 15px;
       min-height: 0;
       border-bottom: 1px solid #d3d3d3;
     }
     :host .dropdown-menu > li {
       display: inline-block;
     }
     :host .navbar-nav > li + li > ::content a:before {
       border-left: 1px solid #e2e2e2;
       padding: 0 15px;
     }
     :host .navbar-nav .dropdown-menu li ::content a {
       padding-top: 8px;
       padding-bottom: 8px;
     }

     :host.sticky-header .main-menu {
       position: fixed;
       top: -1px;
       left: 0;
       right: 0;
       z-index: 1000;
       -webkit-box-shadow: 0 2px 10px 0 rgba(0, 0, 0, 0.15);
       box-shadow: 0 2px 10px 0 rgba(0, 0, 0, 0.15);
     }

     :host.sticky-header .navbar-nav.navbar-right {
       padding-right: 60px;
     }
     :host.sticky-header ::content .navbar-header .navbar-symbol {
       width: 40px;
       height: 37px;
       transition: width 500ms linear, height 500ms linear;

     }
     :host.sticky-header ::content .navbar-header .navbar-symbol:before {
       position: fixed;
       top: 7px;
       right: 10px;
       transition: top 500ms linear, right 500ms linear;
     }

   </style>

<nav class="navbar navbar-default">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#mainMenu" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <ks-main-header id="mainHeader" site-name="Corporate UI Light" site-url="#" short-name="CUI Light" >
        <ks-nav-item href="https://fmpnextgen.scania.com/#/help/dashboard" title="Help" target="_blank" icon-position="right">
          <i class="fa-2x-medium fa fa-truck"></i>
        </ks-nav-item>
        <ks-nav-item href="https://fmpnextgen.scania.com/#/help/dashboard" title="Login" target="_blank"></ks-nav-item>
      </ks-main-header>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse main-menu" id="mainMenu">
      <ul class="nav navbar-nav">
        <li class="active">
          <ks-nav-item href="#1" title="Link 1" icon-position="right">
            <span class="sr-only">(current)</span>
          </ks-nav-item>
        </li>
        <li class="dropdown">
          <ks-nav-item href="#2" title="Link 2" class="dropdown-toggle" data-toggle="dropdown" data-target="submenu-2" role="button"></ks-nav-item>
           <ul class="dropdown-menu" id="submenu-2">
            <li><ks-nav-item href="#2" title="action 2"></ks-nav-item></li>
            <li><ks-nav-item href="#2" title="Another action"></ks-nav-item></li>
            <li><ks-nav-item href="#2" title="Something else here"></ks-nav-item></li>
            <li><ks-nav-item href="#2" title="action 2"></ks-nav-item></li>
            <li><ks-nav-item href="#2" title="action 2"></ks-nav-item></li>
          </ul>
        </li>
        <li><ks-nav-item href="#2" title="Link 2"></ks-nav-item></li>
        <li><ks-nav-item href="#3" title="Link 3"></ks-nav-item></li>
        <li><ks-nav-item href="#4" title="Link 4"></ks-nav-item></li>
        <li><ks-nav-item href="#5" title="Link 5"></ks-nav-item></li>
         <li><a href="#">Action</a></li>

      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li><a href="#">Link</a></li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-target="submenu-2" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Administration <span class="caret"></span></a>
          <ul class="dropdown-menu" id="submenu-3">
           <li><ks-nav-item href="#2" title="Link 2"></ks-nav-item></li>
        <li><ks-nav-item href="#3" title="Link 3"></ks-nav-item></li>
        <li><ks-nav-item href="#4" title="Link 4"></ks-nav-item></li>
        <li><ks-nav-item href="#5" title="Link 5"></ks-nav-item></li>
          </ul>
        </li>
      </ul>
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>

  </template>
  <script>
  Polymer({
    is: 'ks-main-navigation',

    attached: function() {
      window.addEventListener('scroll', this.onWindowScroll.bind(this));
    },

    onWindowScroll: function(event) {
      var currentScrollOffset = $(document).scrollTop(),
              positionOfMainMenuRelativeToTheTop = this.$.mainMenu.offsetTop,
              mainHeaderHeight = this.$.mainHeader.offsetHeight,
              mainNavigationHeight = this.offsetHeight,
              isHeaderSticky = this.$.mainHeader.classList.contains('sticky-header');

      if(currentScrollOffset > 0){
        if(!isHeaderSticky ){
          this.classList.add('sticky-header');
        }
      }else{
        this.classList.remove('sticky-header');
      }
      console.log('currentScrollOffset', currentScrollOffset);
      console.log('positionOfMainMenuRelativeToTheTop', positionOfMainMenuRelativeToTheTop);
      console.log('mainHeaderHeight', mainHeaderHeight);
    }

  });
  </script>

</dom-module>

